function initFeedsApp(e){return new Vue({el:e.rootElement,data:{categories:e.initialData,percentPrecision:e.percentPrecision,activeCategory:Object.keys(e.initialData)[0]},directives:{"instrument-icon":"function"==typeof instrumentIconDirective&&instrumentIconDirective()},computed:{activeInstruments(){return this.categories[this.activeCategory].instruments},activeCategoryName(){return this.categories[this.activeCategory].categoryName},shouldDisplaySideCategoriesTabs(){return this.categoriesLength>1},categoriesLength(){return this.categories&&Object.keys(this.categories).length},categoriesClass(){return this.shouldDisplaySideCategoriesTabs?"categories-"+this.categoriesLength:null}},methods:{updateInstruments(){const t=this,r=t.activeCategory;let i=t.categories[r].instruments;const s=i.map(e=>e.instrumentId);return fetch(e.apiUrl+"?instrumentIds="+s.join(",")).then(function(e){return e.json()}).then(function(e){t.categories[r].instruments=i.map(t=>{const r=e.filter(e=>e.InstrumentId===t.instrumentId.toString())[0];return r&&(t.isSellUpDirection=t.sellPrice===r.SellPrice?void 0:t.sellPrice<r.SellPrice,t.isBuyUpDirection=t.buyPrice===r.buyPrice?void 0:t.buyPrice<r.BuyPrice,t.sellPrice=r.SellPrice,t.buyPrice=r.BuyPrice,t.changeRate=r.ChangePercent),t})}).catch(function(e){console.log(e),t.errorCount+=1,t.errorCount>3&&t.timer&&(window.clearInterval(t.timer),t.timer=void 0,t.errorCount=0)})},resolveInstrumentLangDir(e){if(void 0===e.name)return;return new RegExp("[֐-׾؀-ۿ]","g").test(e.name)?"rtl":"ltr"},resolveSellPriceClass:t=>void 0===t.isSellUpDirection?"":t.isSellUpDirection?e.priceUpClass:e.priceDownClass,resolveBuyPriceClass:t=>void 0===t.isBuyUpDirection?"":t.isBuyUpDirection?e.priceUpClass:e.priceDownClass,resolveThresholdClass:t=>Math.abs(t.changeRate)>=t.threshold?e.thresholdClass:"",resolvePercentClass:t=>t.changeRate>0?e.percentUpClass:t.changeRate<0?e.percentDownClass:"",onCategoryTabClick(e){sendAnalyticsEvent("NewFeedsWidget","CategoryTabSwitch",e),this.activeCategory=e},onTradeClick(e){sendAnalyticsEvent("NewFeedsWidget","InstrumentTradeClick",e)},tableToggle(){this.$refs.hideAfter[0].classList.toggle("show"),this.$refs.tableToggle.classList.toggle("icon-minus3")}},mounted(){var t=this;t.errorCount=0,t.updateInstruments(),"IntersectionObserver"in window?(t.observer=new window.IntersectionObserver(function(r){var i=r[0];i.isIntersecting&&!t.timer&&(t.timer=window.setInterval(t.updateInstruments,e.updateInterval)),!i.isIntersecting&&t.timer&&(window.clearInterval(t.timer),t.timer=void 0)},{threshold:.1,rootMargin:"3%"}),this.observer.observe(document.querySelector(e.rootElement))):t.timer=window.setInterval(t.updateInstruments,e.updateInterval)}})}